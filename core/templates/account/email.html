{% extends "account/base.html" %}
{% load i18n %}

{% block head_title %}{% trans "Mes adresses e‑mail" %}{% endblock %}
{% block page_heading %}{% trans "Mes adresses e‑mail" %}{% endblock %}

{% block account_content %}
<div class="row justify-content-center">
  <div class="col-lg-8 col-md-10">

    <h3 class="mb-3">{% trans "Adresses associées" %}</h3>
    <form method="post" action="{% url 'account_email' %}">
      {% csrf_token %}
      {% if user.emailaddress_set.all %}
        <ul class="list-group mb-3">
          {% for emailaddress in user.emailaddress_set.all %}
            <li class="list-group-item d-flex justify-content-between align-items-center">
              <span>
                {% if emailaddress.primary %}<strong>{{ emailaddress.email }}</strong>{% else %}{{ emailaddress.email }}{% endif %}
                {% if emailaddress.verified %}
                  <span class="badge badge-success ml-2">{% trans "Vérifiée" %}</span>
                {% else %}
                  <span class="badge badge-warning ml-2">{% trans "Non vérifiée" %}</span>
                {% endif %}
              </span>
              <span>
                {% if not emailaddress.primary %}
                  <button class="btn btn-sm btn-outline-secondary" type="submit" name="action_primary" value="{{ emailaddress.id }}">{% trans "Définir principale" %}</button>
                {% endif %}
                <button class="btn btn-sm btn-outline-danger" type="submit" name="action_remove" value="{{ emailaddress.id }}">{% trans "Supprimer" %}</button>
                {% if not emailaddress.verified %}
                  <button class="btn btn-sm btn-outline-success" type="submit" name="action_send" value="{{ emailaddress.id }}">{% trans "Renvoyer la confirmation" %}</button>
                {% endif %}
              </span>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p class="text-muted">{% trans "Aucune adresse enregistrée." %}</p>
      {% endif %}

      <h3 class="mb-3">{% trans "Ajouter une adresse" %}</h3>
      {{ add_email_form.non_field_errors }}
      <div class="form-group">
        <label for="{{ add_email_form.email.id_for_label }}">{{ add_email_form.email.label }}</label>
        {{ add_email_form.email }}
        {{ add_email_form.email.errors }}
      </div>
      <button class="btn btn-success" name="action_add" type="submit">{% trans "Ajouter" %}</button>
    </form>

  </div>
</div>
{% endblock %}
